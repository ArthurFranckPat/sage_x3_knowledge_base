<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SQL Playground - Sage X3</title>
  
  @vite(['resources/css/app.css', 'resources/js/app.js'])
</head>
<body>
  <!-- App Shell -->
  <div class="app-shell">
    
    <!-- Header -->
    <header class="app-header">
      <div class="app-header-title">
        <span class="app-header-logo">🚀</span>
        <span>SQL Playground - Sage X3</span>
      </div>
      <div class="app-header-actions">
        <button class="btn btn-ghost btn-icon" onclick="toggleTheme()" title="Toggle theme">
          <span class="dark-hidden">🌙</span>
          <span class="light-hidden">☀️</span>
        </button>
        <button class="btn btn-ghost btn-icon" onclick="showShortcuts()" title="Keyboard shortcuts (?)">
          ⌨️
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <div class="app-main">
      
      <!-- Sidebar -->
      <aside class="app-sidebar">
        <button 
          class="sidebar-icon-btn" 
          up-layer="new drawer" 
          up-href="/playground/schema" 
          up-size="large"
          title="Schema Explorer">
          📊
        </button>
        
        <button 
          class="sidebar-icon-btn"
          up-layer="new drawer" 
          up-href="/playground/history"
          up-size="large"
          title="History">
          📝
        </button>
        
        <button 
          class="sidebar-icon-btn"
          up-layer="new drawer" 
          up-href="/playground/favorites"
          up-size="large"
          title="Favorites">
          ⭐
        </button>
      </aside>

      <!-- Content Area (Split View) -->
      <div class="app-content">
        
        <!-- Editor Panel (Left) -->
        <div class="editor-panel">
          <div class="editor-container">
            
            <!-- Monaco Editor -->
            <div class="editor-wrapper">
              <div id="monaco-editor">
                <!-- Fallback textarea -->
                <textarea 
                  id="sql-fallback-editor" 
                  style="width: 100%; height: 100%; font-family: monospace; padding: 10px; border: none; resize: none;"
                  placeholder="Loading Monaco Editor...">SELECT * FROM itmmaster LIMIT 10</textarea>
              </div>
            </div>

            <!-- Validation Section -->
            <div class="validation-section">
              <div id="validation-container">
                <div id="validation" up-hungry up-keep>
                  @if(validation)
                    @include('playground/partials/validation')
                  @end
                </div>
              </div>
            </div>

            <!-- Actions -->
            <form 
              id="sql-form"
              up-submit 
              up-target="#results-container, #validation-container" 
              up-fail-target="#validation-container"
              method="POST" 
              action="/api/playground/execute"
              onsubmit="return copyEditorToInput()">
              
              {{ csrfField() }}
              <input type="hidden" name="sql" id="sql-input">
              
              <div class="editor-actions" up-keep>
                <button type="submit" class="btn btn-success" up-disable-with="⏳ Executing...">
                  ▶️ Execute Query
                </button>
                
                <button 
                  type="button" 
                  class="btn btn-destructive"
                  onclick="window.sqlEditor?.setValue('SELECT * FROM itmmaster LIMIT 10')">
                  🔄 Reset
                </button>
                
                <button 
                  type="button" 
                  class="btn btn-outline"
                  up-validate 
                  up-target="#validation-container"
                  up-method="POST"
                  up-url="/api/playground/validate"
                  onclick="document.querySelector('#sql-input').value = window.sqlEditor?.getValue() || ''">
                  ✓ Validate
                </button>
              </div>
            </form>

          </div>
        </div>

        <!-- Results Panel (Right) -->
        <div class="results-panel">
          <div class="results-container">
            
            <!-- Results Header -->
            <div class="results-header">
              <h2 class="results-title">Query Results</h2>
              <div class="results-metrics">
                <!-- Metrics badges will be added here -->
              </div>
            </div>

            <!-- Results Content -->
            <div id="results-container">
              <div id="results" up-hungry>
                @if(result)
                  @include('playground/partials/results')
                @else
                  <div class="results-empty">
                    <div class="results-empty-icon">📊</div>
                    <div class="results-empty-title">No results yet</div>
                    <div class="results-empty-description">
                      Execute a SQL query to see results here
                    </div>
                  </div>
                @end
              </div>
            </div>

          </div>
        </div>

      </div>
    </div>

  </div>

  <style>
    .dark-hidden { display: none; }
    .dark .dark-hidden { display: inline; }
    .dark .light-hidden { display: none; }
    .light-hidden { display: inline; }
  </style>
</body>
</html>
